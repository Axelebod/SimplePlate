<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SimplePlate - √âditeur Templates Tailwind Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --primary: #8b5cf6;
      --primary-dark: #7c3aed;
      --primary-light: #a78bfa;
      --accent: #ec4899;
      --accent-dark: #db2777;
      --dark: #1f2937;
      --light: #f9fafb;
      --text: #111827;
      --text-muted: #6b7280;
      --border: #e5e7eb;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
    }
    
    /* Variables pour le mode sombre */
    [data-theme="dark"] {
      --primary: #a78bfa;
      --primary-dark: #8b5cf6;
      --primary-light: #c4b5fd;
      --accent: #f472b6;
      --accent-dark: #ec4899;
      --dark: #f9fafb;
      --light: #111827;
      --text: #f9fafb;
      --text-muted: #9ca3af;
      --border: #374151;
      --success: #34d399;
      --warning: #fbbf24;
      --error: #f87171;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    /* Loading Screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      transition: opacity 0.5s ease-out;
    }
    
    .loading-screen.fade-out {
      opacity: 0;
      pointer-events: none;
    }
    
    .loading-content {
      text-align: center;
      animation: fadeInUp 0.8s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .loading-logo {
      background: rgba(255, 255, 255, 0.95);
      width: 120px;
      height: 120px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 48px;
      margin: 0 auto 30px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      background: linear-gradient(135deg, white 0%, #f3f4f6 100%);
      animation: pulse 2s ease-in-out infinite;
    }
    
    .loading-logo span {
      background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .loading-text {
      color: white;
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 16px;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }
    
    .loading-subtext {
      color: rgba(255, 255, 255, 0.9);
      font-size: 16px;
      margin-bottom: 40px;
    }
    
    .loading-progress {
      width: 300px;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      overflow: hidden;
      margin: 0 auto 30px;
    }
    
    .loading-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #8b5cf6, #ec4899, #8b5cf6);
      background-size: 200% 100%;
      animation: progressAnimation 2s ease-in-out, shimmer 2s linear infinite;
      width: 100%;
    }
    
    @keyframes progressAnimation {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    .loading-recommendation {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      padding: 16px 32px;
      border-radius: 12px;
      color: white;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      margin-top: 20px;
      animation: slideInUp 1s ease-out 0.5s backwards;
    }
    
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .loading-icon {
      font-size: 24px;
    }
    
    /* Main app styles */
    body {
      font-family: 'Inter', sans-serif;
      display: flex;
      height: 100vh;
      color: var(--text);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow: hidden;
      transition: background 0.3s, color 0.3s;
    }
    
    body[data-theme="dark"] {
      background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.03);
      pointer-events: none;
      z-index: 0;
    }
    
    body[data-theme="dark"]::before {
      background: rgba(0, 0, 0, 0.2);
    }
    
    .app-container {
      display: none;
      width: 100%;
      height: 100%;
    }
    
    .app-container.show {
      display: flex;
    }
    
    .top-toolbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 64px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(229, 231, 235, 0.5);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      z-index: 1000;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: all 0.3s;
    }
    
    body[data-theme="dark"] .top-toolbar {
      background: rgba(17, 24, 39, 0.95);
      border-bottom: 1px solid rgba(55, 65, 81, 0.5);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .logo-icon {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 16px;
      box-shadow: 0 4px 6px -1px rgba(139, 92, 246, 0.25);
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .logo-text {
      font-size: 1.25rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .toolbar-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      box-shadow: 0 4px 6px -1px rgba(139, 92, 246, 0.25);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(139, 92, 246, 0.3);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      color: white;
      box-shadow: 0 4px 6px -1px rgba(236, 72, 153, 0.25);
    }
    
    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(236, 72, 153, 0.3);
    }
    
    .btn-outline {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid var(--border);
      color: var(--text);
    }
    
    body[data-theme="dark"] .btn-outline {
      background: rgba(17, 24, 39, 0.9);
      color: var(--dark);
    }
    
    .btn-outline:hover {
      background: white;
      border-color: var(--primary);
      color: var(--primary);
      transform: translateY(-2px);
    }
    
    body[data-theme="dark"] .btn-outline:hover {
      background: var(--dark);
    }
    
    .left-sidebar {
      width: 320px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(229, 231, 235, 0.5);
      margin-top: 64px;
      overflow-y: auto;
      height: calc(100vh - 64px);
      position: relative;
      z-index: 100;
      box-shadow: 4px 0 6px -1px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
    }
    
    body[data-theme="dark"] .left-sidebar {
      background: rgba(17, 24, 39, 0.95);
      border-right: 1px solid rgba(55, 65, 81, 0.5);
    }
    
    .sidebar-section {
      border-bottom: 1px solid var(--border);
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .sidebar-header {
      padding: 16px 20px;
      font-weight: 600;
      color: var(--dark);
      background: linear-gradient(to right, rgba(139, 92, 246, 0.05), rgba(236, 72, 153, 0.05));
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.3s;
      user-select: none;
    }
    
    body[data-theme="dark"] .sidebar-header {
      color: var(--light);
      background: linear-gradient(to right, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.1));
    }
    
    .sidebar-header:hover {
      background: linear-gradient(to right, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.1));
    }
    
    .toggle-icon {
      transition: transform 0.3s;
      font-size: 12px;
    }
    
    .sidebar-content {
      padding: 20px;
      max-height: 400px;
      overflow-y: auto;
      transition: all 0.3s ease-out;
    }
    
    .sidebar-content.collapsed {
      max-height: 0;
      padding: 0 20px;
      overflow: hidden;
    }
    
    .main-area {
      flex: 1;
      margin-top: 64px;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }
    
    .viewport-controls {
      padding: 12px 24px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(229, 231, 235, 0.5);
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
    }
    
    body[data-theme="dark"] .viewport-controls {
      background: rgba(17, 24, 39, 0.95);
      border-bottom: 1px solid rgba(55, 65, 81, 0.5);
    }
    
    .viewport-buttons {
      display: flex;
      gap: 8px;
      background: rgba(243, 244, 246, 0.5);
      padding: 4px;
      border-radius: 10px;
    }
    
    body[data-theme="dark"] .viewport-buttons {
      background: rgba(55, 65, 81, 0.5);
    }
    
    .viewport-btn {
      padding: 8px 16px;
      border: none;
      background: transparent;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      transition: all 0.3s;
    }
    
    .viewport-btn.active {
      background: white;
      color: var(--primary);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    body[data-theme="dark"] .viewport-btn.active {
      background: var(--dark);
    }
    
    .canvas-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      overflow: auto;
      position: relative;
    }
    
    .canvas-wrapper {
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      position: relative;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      width: 100%;
      max-width: 1200px;
      height: 85vh;
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }
    
    body[data-theme="dark"] .canvas-wrapper {
      background: #1f2937;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
    
    .canvas-wrapper.tablet {
      max-width: 768px;
    }
    
    .canvas-wrapper.mobile {
      max-width: 375px;
    }
    
    .canvas {
      width: 100%;
      height: 100%;
      border: none;
      background: white;
      border-radius: 12px;
    }
    
    body[data-theme="dark"] .canvas {
      background: #1f2937;
    }
    
    .drop-zone {
      width: 100%;
      height: 100%;
      border: 3px dashed rgba(139, 92, 246, 0.3);
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      text-align: center;
      padding: 48px;
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.02) 0%, rgba(236, 72, 153, 0.02) 100%);
    }
    
    body[data-theme="dark"] .drop-zone {
      border-color: rgba(139, 92, 246, 0.5);
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);
    }
    
    .drop-zone.active {
      border-color: var(--primary);
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
      transform: scale(0.98);
    }
    
    .drop-zone h3 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 12px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .drop-zone p {
      color: var(--text-muted);
      margin-bottom: 24px;
      max-width: 400px;
    }
    
    .right-panel {
      width: 360px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-left: 1px solid rgba(229, 231, 235, 0.5);
      margin-top: 64px;
      overflow-y: auto;
      height: calc(100vh - 64px);
      position: relative;
      z-index: 100;
      box-shadow: -4px 0 6px -1px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
    }
    
    body[data-theme="dark"] .right-panel {
      background: rgba(17, 24, 39, 0.95);
      border-left: 1px solid rgba(55, 65, 81, 0.5);
    }
    
    .property-section {
      padding: 24px;
      border-bottom: 1px solid var(--border);
      animation: slideInRight 0.3s ease-out;
    }
    
    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .property-title {
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--dark);
      font-size: 15px;
    }
    
    body[data-theme="dark"] .property-title {
      color: var(--light);
    }
    
    .property-group {
      margin-bottom: 16px;
    }
    
    .property-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 6px;
      display: block;
      font-weight: 500;
    }
    
    .property-input {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
      background: white;
      color: var(--text);
    }
    
    body[data-theme="dark"] .property-input {
      background: #1f2937;
      border-color: var(--border);
      color: var(--light);
    }
    
    .property-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
    }
    
    .element-inspector {
      max-height: 300px;
      overflow-y: auto;
      border: 2px solid var(--border);
      border-radius: 8px;
      background: linear-gradient(to bottom, #f9fafb, #ffffff);
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 12px;
    }
    
    body[data-theme="dark"] .element-inspector {
      background: linear-gradient(to bottom, #111827, #1f2937);
    }
    
    .element-item {
      padding: 10px 14px;
      cursor: pointer;
      border-bottom: 1px solid rgba(229, 231, 235, 0.5);
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
    }
    
    body[data-theme="dark"] .element-item {
      border-bottom: 1px solid rgba(55, 65, 81, 0.5);
    }
    
    .element-item:hover {
      background: linear-gradient(to right, rgba(139, 92, 246, 0.05), rgba(236, 72, 153, 0.05));
      padding-left: 18px;
    }
    
    .element-item.selected {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      color: white;
    }
    
    .element-item.editable {
      border-left: 3px solid var(--accent);
    }
    
    .notification {
      position: fixed;
      top: 84px;
      right: 24px;
      padding: 14px 20px;
      border-radius: 10px;
      color: white;
      z-index: 2000;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      transform: translateX(150%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    .notification.success { 
      background: linear-gradient(135deg, var(--success), #059669);
    }
    .notification.error { 
      background: linear-gradient(135deg, var(--error), #dc2626);
    }
    .notification.warning { 
      background: linear-gradient(135deg, var(--warning), #d97706);
    }
    
    .notification::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .class-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 10px;
    }
    
    .class-item {
      background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 4px 10px;
      font-size: 12px;
      font-family: 'Monaco', 'Consolas', monospace;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }
    
    body[data-theme="dark"] .class-item {
      background: linear-gradient(135deg, #374151, #4b5563);
      border-color: var(--border);
    }
    
    .class-item.tailwind {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
      border-color: rgba(139, 92, 246, 0.3);
      color: var(--primary-dark);
    }
    
    body[data-theme="dark"] .class-item.tailwind {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
      color: var(--primary-light);
    }
    
    .class-item:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    .class-item.tailwind:hover {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
      border-color: var(--primary);
    }
    
    /* Loading animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.05);
      border-radius: 10px;
    }
    
    body[data-theme="dark"] ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, var(--primary-dark), var(--accent-dark));
    }
    
    /* Search bar */
    .search-container {
      position: relative;
      margin-bottom: 16px;
    }
    
    .search-input {
      width: 100%;
      padding: 10px 36px 10px 12px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      background: white;
      color: var(--text);
      transition: all 0.3s;
    }
    
    body[data-theme="dark"] .search-input {
      background: #1f2937;
      border-color: var(--border);
      color: var(--light);
    }
    
    .search-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
    }
    
    .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
    }
    
    /* Theme toggle */
    .theme-toggle {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.3s;
      color: var(--text);
    }
    
    .theme-toggle:hover {
      background: rgba(139, 92, 246, 0.1);
    }
    
    /* Auto-save indicator */
    .auto-save-indicator {
      font-size: 12px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .saving {
      animation: pulse 1s infinite;
    }
    
    /* Preview classes */
    .preview-classes {
      background: rgba(139, 92, 246, 0.05);
      border: 1px dashed rgba(139, 92, 246, 0.3);
      border-radius: 6px;
      padding: 8px;
      margin-top: 8px;
      font-size: 12px;
      font-family: monospace;
      max-height: 100px;
      overflow-y: auto;
    }
  </style>
</head>
<body data-theme="light">
  <!-- √âcran de chargement -->
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-content">
      <div class="loading-logo">
        <span>SP</span>
      </div>
      <h1 class="loading-text">SimplePlate</h1>
      <p class="loading-subtext">√âditeur de templates professionnel</p>
      <div class="loading-progress">
        <div class="loading-progress-bar"></div>
      </div>
      <div class="loading-recommendation">
        <span class="loading-icon">üíª</span>
        <span>Pour une meilleure exp√©rience, nous recommandons d'utiliser SimplePlate sur ordinateur</span>
      </div>
    </div>
  </div>
  
  <!-- Application principale -->
  <div class="app-container" id="appContainer">
    <!-- Toolbar sup√©rieure -->
    <div class="top-toolbar">
      <div class="logo">
        <div class="logo-icon">SP</div>
        <div class="logo-text">SimplePlate Pro</div>
      </div>
      
      <div class="toolbar-actions">
        <button class="theme-toggle" id="themeToggle" title="Changer le th√®me">
          üåô
        </button>
        <button class="btn btn-outline" id="undoBtn" disabled>
          <span>‚Ü∂</span> Annuler
        </button>
        <button class="btn btn-outline" id="redoBtn" disabled>
          <span>‚Ü∑</span> R√©tablir
        </button>
        <button class="btn btn-secondary" id="previewBtn">
          <span>üëÅÔ∏è</span> Aper√ßu
        </button>
        <button class="btn btn-primary" id="exportBtn">
          <span>üíæ</span> Exporter
        </button>
      </div>
    </div>
    
    <!-- Sidebar gauche -->
    <div class="left-sidebar">
      <!-- Section Import -->
      <div class="sidebar-section">
        <div class="sidebar-header" data-section="import">
          <span>üì• Importer template</span>
          <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="sidebar-content">
          <div class="property-group">
            <button class="btn btn-primary" id="uploadHtmlBtn" style="width: 100%; margin-bottom: 10px;">
              <span>üìÅ</span> Choisir fichier HTML
            </button>
            <input type="file" id="htmlUpload" accept=".html,.htm" style="display: none;">
          </div>
          
          <div class="property-group">
            <label class="property-label">Ou coller votre code HTML :</label>
            <textarea id="htmlCodeInput" class="property-input" rows="4" placeholder="Collez votre code HTML ici..."></textarea>
            <button class="btn btn-secondary" id="loadFromCodeBtn" style="width: 100%; margin-top: 8px;">
              <span>‚ö°</span> Charger le template
            </button>
          </div>
          
          <div class="property-group">
            <button class="btn btn-outline" id="loadExampleBtn" style="width: 100%;">
              <span>üé®</span> Charger un exemple
            </button>
          </div>
        </div>
      </div>
      
      <!-- Section √âl√©ments -->
      <div class="sidebar-section">
        <div class="sidebar-header" data-section="elements">
          <span>üèóÔ∏è Structure du template</span>
          <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="sidebar-content">
          <div class="search-container">
            <input type="text" id="elementSearch" class="search-input" placeholder="Rechercher un √©l√©ment...">
            <span class="search-icon">üîç</span>
          </div>
          <div id="elementInspector" class="element-inspector">
            <div style="padding: 24px; text-align: center; color: var(--text-muted);">
              <div style="font-size: 32px; margin-bottom: 12px;">üì¶</div>
              Chargez un template pour voir sa structure
            </div>
          </div>
        </div>
      </div>
      
      <!-- Section Tailwind -->
      <div class="sidebar-section">
        <div class="sidebar-header" data-section="tailwind">
          <span>‚ö° Classes Tailwind rapides</span>
          <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="sidebar-content">
          <div class="property-group">
            <label class="property-label">üé® Couleurs de fond</label>
            <div class="class-list">
              <span class="class-item tailwind" data-class="bg-white">bg-white</span>
              <span class="class-item tailwind" data-class="bg-gray-50">bg-gray-50</span>
              <span class="class-item tailwind" data-class="bg-gray-900">bg-gray-900</span>
              <span class="class-item tailwind" data-class="bg-blue-500">bg-blue-500</span>
              <span class="class-item tailwind" data-class="bg-red-500">bg-red-500</span>
              <span class="class-item tailwind" data-class="bg-green-500">bg-green-500</span>
              <span class="class-item tailwind" data-class="bg-purple-500">bg-purple-500</span>
              <span class="class-item tailwind" data-class="bg-gradient-to-r">bg-gradient-to-r</span>
            </div>
          </div>
          
          <div class="property-group">
            <label class="property-label">‚úèÔ∏è Couleurs de texte</label>
            <div class="class-list">
              <span class="class-item tailwind" data-class="text-black">text-black</span>
              <span class="class-item tailwind" data-class="text-white">text-white</span>
              <span class="class-item tailwind" data-class="text-gray-600">text-gray-600</span>
              <span class="class-item tailwind" data-class="text-blue-600">text-blue-600</span>
              <span class="class-item tailwind" data-class="text-red-600">text-red-600</span>
            </div>
          </div>
          
          <div class="property-group">
            <label class="property-label">üìê Espacement</label>
            <div class="class-list">
              <span class="class-item tailwind" data-class="p-2">p-2</span>
              <span class="class-item tailwind" data-class="p-4">p-4</span>
              <span class="class-item tailwind" data-class="p-8">p-8</span>
              <span class="class-item tailwind" data-class="px-4">px-4</span>
              <span class="class-item tailwind" data-class="py-4">py-4</span>
              <span class="class-item tailwind" data-class="m-4">m-4</span>
              <span class="class-item tailwind" data-class="mx-auto">mx-auto</span>
              <span class="class-item tailwind" data-class="mb-4">mb-4</span>
              <span class="class-item tailwind" data-class="mt-8">mt-8</span>
              <span class="class-item tailwind" data-class="space-x-4">space-x-4</span>
            </div>
          </div>
          
          <div class="property-group">
            <label class="property-label">üìù Typographie</label>
            <div class="class-list">
              <span class="class-item tailwind" data-class="text-xs">text-xs</span>
              <span class="class-item tailwind" data-class="text-sm">text-sm</span>
              <span class="class-item tailwind" data-class="text-base">text-base</span>
              <span class="class-item tailwind" data-class="text-lg">text-lg</span>
              <span class="class-item tailwind" data-class="text-xl">text-xl</span>
              <span class="class-item tailwind" data-class="text-2xl">text-2xl</span>
              <span class="class-item tailwind" data-class="text-3xl">text-3xl</span>
              <span class="class-item tailwind" data-class="font-bold">font-bold</span>
              <span class="class-item tailwind" data-class="font-light">font-light</span>
            </div>
          </div>
          
          <div class="property-group">
            <label class="property-label">üé≠ Effets & Animation</label>
            <div class="class-list">
              <span class="class-item tailwind" data-class="shadow-lg">shadow-lg</span>
              <span class="class-item tailwind" data-class="rounded-lg">rounded-lg</span>
              <span class="class-item tailwind" data-class="hover:scale-105">hover:scale-105</span>
              <span class="class-item tailwind" data-class="transition-all">transition-all</span>
              <span class="class-item tailwind" data-class="duration-300">duration-300</span>
              <span class="class-item tailwind" data-class="animate-pulse">animate-pulse</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Zone principale -->
    <div class="main-area">
      <!-- Contr√¥les de viewport -->
      <div class="viewport-controls">
        <div class="viewport-buttons">
          <button class="viewport-btn active" data-viewport="desktop">üñ•Ô∏è Desktop</button>
          <button class="viewport-btn" data-viewport="tablet">üì± Tablet</button>
          <button class="viewport-btn" data-viewport="mobile">üì± Mobile</button>
        </div>
        
        <div style="display: flex; align-items: center; gap: 12px;">
          <span id="elementPath" style="font-size: 12px; color: var(--text-muted); font-family: monospace;"></span>
          <span class="auto-save-indicator" id="autoSaveIndicator">
            <span class="saving" style="display: none;">‚è≥</span>
            <span id="saveStatus">Sauvegard√©</span>
          </span>
        </div>
      </div>
      
      <!-- Container du canvas -->
      <div class="canvas-container">
        <div class="canvas-wrapper" id="canvasWrapper">
          <div class="drop-zone" id="dropZone">
            <h3>üöÄ Importez votre template HTML</h3>
            <p>Glissez-d√©posez votre fichier HTML ici, ou utilisez les boutons de la sidebar pour importer votre template avec Tailwind CSS.</p>
            <div style="margin-top: 24px;">
              <button class="btn btn-primary" onclick="document.getElementById('htmlUpload').click()">
                <span>üìÅ</span> Choisir un fichier
              </button>
            </div>
          </div>
          
          <iframe class="canvas" id="templateFrame" style="display: none;"></iframe>
        </div>
      </div>
    </div>
    
    <!-- Panneau de propri√©t√©s √† droite -->
    <div class="right-panel">
      <div class="property-section">
        <div class="property-title">üéØ √âl√©ment s√©lectionn√©</div>
        <div id="elementInfo">
          <p style="color: var(--text-muted); text-align: center; margin-top: 24px;">
            <span style="font-size: 32px;">üëÜ</span><br>
            Cliquez sur un √©l√©ment dans le template pour le modifier
          </p>
        </div>
      </div>
      
      <div class="property-section">
        <div class="property-title">üé® Classes CSS</div>
        <div class="property-group">
          <label class="property-label">Classes actuelles</label>
          <textarea id="classEditor" class="property-input" rows="3" placeholder="Pas d'√©l√©ment s√©lectionn√©"></textarea>
          <div id="classPreview" class="preview-classes" style="display: none;">
            Aper√ßu des classes...
          </div>
          <button class="btn btn-primary" id="updateClassesBtn" style="width: 100%; margin-top: 8px;">
            <span>‚úèÔ∏è</span> Mettre √† jour les classes
          </button>
        </div>
        
        <div class="property-group">
          <label class="property-label">Classes de l'√©l√©ment</label>
          <div id="currentClasses" class="class-list">
            <!-- Classes seront affich√©es ici -->
          </div>
        </div>
      </div>
      
      <div class="property-section">
        <div class="property-title">üìù Contenu</div>
        <div class="property-group">
          <label class="property-label">Texte de l'√©l√©ment</label>
          <textarea id="textEditor" class="property-input" rows="3" placeholder="Pas d'√©l√©ment s√©lectionn√©"></textarea>
          <button class="btn btn-primary" id="updateTextBtn" style="width: 100%; margin-top: 8px;">
            <span>üí¨</span> Mettre √† jour le texte
          </button>
        </div>
      </div>
      
      <div class="property-section">
        <div class="property-title">‚ö° Actions rapides</div>
        <div class="property-group">
          <button class="btn btn-secondary" id="quickEditBtn" style="width: 100%; margin-bottom: 8px;">
            <span>‚ú®</span> √âdition rapide (ou double-clic)
          </button>
          <button class="btn btn-outline" id="duplicateBtn" style="width: 100%; margin-bottom: 8px;">
            <span>üìã</span> Dupliquer l'√©l√©ment
          </button>
          <button class="btn btn-outline" id="deleteBtn" style="width: 100%; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none;">
            <span>üóëÔ∏è</span> Supprimer l'√©l√©ment
          </button>
        </div>
      </div>
    </div>
    
    <!-- Notification -->
    <div id="notification" class="notification"></div>
  </div>

  <script>
    // Variables globales
    let templateFrame = document.getElementById('templateFrame');
    let dropZone = document.getElementById('dropZone');
    let selectedElement = null;
    let templateDoc = null;
    let history = [];
    let redoStack = [];
    let maxHistorySize = 50;
    let autoSaveTimer = null;
    let isAutoSaving = false;
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', function() {
      // Cacher l'√©cran de chargement apr√®s 2.5 secondes
      setTimeout(() => {
        const loadingScreen = document.getElementById('loadingScreen');
        const appContainer = document.getElementById('appContainer');
        
        loadingScreen.classList.add('fade-out');
        appContainer.classList.add('show');
        
        setTimeout(() => {
          loadingScreen.style.display = 'none';
        }, 500);
        
        // Charger le th√®me sauvegard√©
        const savedTheme = localStorage.getItem('simpleplate-theme') || 'light';
        document.body.setAttribute('data-theme', savedTheme);
        updateThemeToggleIcon();
        
        // Charger le dernier template s'il existe
        const savedTemplate = localStorage.getItem('simpleplate-template');
        if (savedTemplate) {
          setTimeout(() => {
            loadTemplate(savedTemplate);
            showNotification('Template pr√©c√©dent charg√© automatiquement', 'success');
          }, 300);
        }
        
        // Initialiser les √©couteurs d'√©v√©nements
        initEventListeners();
        showNotification('SimplePlate Pro charg√© avec succ√®s ! üöÄ', 'success');
      }, 2500);
    });
    
    // Initialiser tous les √©couteurs d'√©v√©nements
    function initEventListeners() {
      // Th√®me
      document.getElementById('themeToggle').addEventListener('click', toggleTheme);
      
      // Historique
      document.getElementById('undoBtn').addEventListener('click', undo);
      document.getElementById('redoBtn').addEventListener('click', redo);
      
      // Import/Export
      document.getElementById('uploadHtmlBtn').addEventListener('click', () => {
        document.getElementById('htmlUpload').click();
      });
      
      document.getElementById('htmlUpload').addEventListener('change', handleFileUpload);
      document.getElementById('loadFromCodeBtn').addEventListener('click', loadFromCode);
      document.getElementById('loadExampleBtn').addEventListener('click', loadExample);
      
      // √âdition
      document.getElementById('updateClassesBtn').addEventListener('click', updateClasses);
      document.getElementById('updateTextBtn').addEventListener('click', updateText);
      document.getElementById('quickEditBtn').addEventListener('click', quickEdit);
      document.getElementById('duplicateBtn').addEventListener('click', duplicateElement);
      document.getElementById('deleteBtn').addEventListener('click', deleteElement);
      
      // Pr√©visualisation et export
      document.getElementById('previewBtn').addEventListener('click', previewTemplate);
      document.getElementById('exportBtn').addEventListener('click', exportTemplate);
      
      // Viewport
      document.querySelectorAll('.viewport-btn').forEach(btn => {
        btn.addEventListener('click', changeViewport);
      });
      
      // Recherche d'√©l√©ments
      document.getElementById('elementSearch').addEventListener('input', searchElements);
      
      // Classes Tailwind rapides
      document.querySelectorAll('.class-item.tailwind').forEach(item => {
        item.addEventListener('click', addTailwindClass);
      });
      
      // Aper√ßu des classes
      document.getElementById('classEditor').addEventListener('input', previewClasses);
      
      // Drop zone
      dropZone.addEventListener('dragover', handleDragOver);
      dropZone.addEventListener('dragleave', handleDragLeave);
      dropZone.addEventListener('drop', handleDrop);
      
      // Sections pliables
      document.querySelectorAll('.sidebar-header').forEach(header => {
        header.addEventListener('click', toggleSection);
      });
    }
    
    // Fonction pour afficher les notifications avec ic√¥nes
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      const icons = {
        success: '‚úÖ',
        error: '‚ùå',
        warning: '‚ö†Ô∏è'
      };
      notification.innerHTML = `<span>${icons[type] || 'üì¢'}</span> ${message}`;
      notification.className = `notification ${type}`;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3500);
    }
    
    // Basculer entre les th√®mes clair/sombre
    function toggleTheme() {
      const currentTheme = document.body.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      document.body.setAttribute('data-theme', newTheme);
      localStorage.setItem('simpleplate-theme', newTheme);
      updateThemeToggleIcon();
      
      showNotification(`Th√®me ${newTheme === 'light' ? 'clair' : 'sombre'} activ√©`, 'success');
    }
    
    // Mettre √† jour l'ic√¥ne du bouton de th√®me
    function updateThemeToggleIcon() {
      const themeToggle = document.getElementById('themeToggle');
      const currentTheme = document.body.getAttribute('data-theme');
      themeToggle.textContent = currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
    }
    
    // Charger un template HTML am√©lior√©
    function loadTemplate(htmlContent) {
      try {
        // Ajouter Tailwind CSS si pas pr√©sent
        if (!htmlContent.includes('tailwindcss.com') && !htmlContent.includes('tailwind.css')) {
          const tailwindScript = '<script src="https://cdn.tailwindcss.com"><\/script>';
          if (htmlContent.includes('</head>')) {
            htmlContent = htmlContent.replace('</head>', tailwindScript + '\n</head>');
          } else {
            htmlContent = tailwindScript + '\n' + htmlContent;
          }
        }
        
        // Afficher l'iframe et cacher la drop zone avec animation
        dropZone.style.display = 'none';
        templateFrame.style.display = 'block';
        
        // Utiliser srcdoc pour une meilleure compatibilit√©
        templateFrame.srcdoc = htmlContent;
        
        // Attendre que l'iframe soit charg√©e
        templateFrame.onload = function() {
          setTimeout(() => {
            try {
              setupTemplateInteraction();
              buildElementTree();
              addToHistory();
              autoSave();
              showNotification('‚ú® Template charg√© avec succ√®s !', 'success');
            } catch (error) {
              console.error('Erreur lors de la configuration:', error);
              showNotification('Template charg√© (mode compatibilit√©)', 'warning');
            }
          }, 500);
        };
        
      } catch (error) {
        console.error('Erreur lors du chargement:', error);
        showNotification('Erreur lors du chargement du template', 'error');
      }
    }
    
    // Configuration avanc√©e de l'interaction avec le template - VERSION AM√âLIOR√âE
    function setupTemplateInteraction() {
      try {
        templateDoc = templateFrame.contentDocument || templateFrame.contentWindow.document;
        
        if (!templateDoc || !templateDoc.body) {
          throw new Error('Impossible d\'acc√©der au document');
        }
        
        // Ajouter les styles pour l'√©dition avec animations
        const editStyles = document.createElement('style');
        editStyles.textContent = `
          .sp-editable { 
            cursor: pointer !important; 
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          }
          .sp-editable:hover { 
            outline: 2px solid #8b5cf6 !important;
            outline-offset: 3px !important;
            filter: brightness(1.05);
          }
          .sp-selected { 
            outline: 3px solid #ec4899 !important;
            outline-offset: 3px !important;
            background: rgba(236, 72, 153, 0.05) !important;
            animation: pulse 2s infinite;
          }
          @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
          }
          .sp-highlight {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2)) !important;
            animation: highlight 0.5s ease-out;
          }
          @keyframes highlight {
            from { background: rgba(139, 92, 246, 0.4); }
            to { background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2)); }
          }
          [contenteditable="true"] {
            background: rgba(139, 92, 246, 0.05) !important;
            padding: 2px 4px !important;
            border-radius: 4px !important;
            min-height: 20px !important;
          }
          [contenteditable="true"]:focus {
            outline: 2px dashed #8b5cf6 !important;
            outline-offset: 2px !important;
            background: rgba(139, 92, 246, 0.1) !important;
          }
        `;
        templateDoc.head.appendChild(editStyles);
        
        // Rendre tous les √©l√©ments interactifs avec gestion SIMPLIFI√âE et FONCTIONNELLE
        const allElements = templateDoc.querySelectorAll('body *');
        allElements.forEach((element, index) => {
          if (element.tagName && 
              !['SCRIPT', 'STYLE', 'META', 'LINK', 'TITLE', 'NOSCRIPT'].includes(element.tagName)) {
            
            element.classList.add('sp-editable');
            element.dataset.spIndex = index;
            
            // Supprimer les anciens √©couteurs et ajouter les nouveaux
            const newElement = element.cloneNode(true);
            element.parentNode.replaceChild(newElement, element);
            
            newElement.addEventListener('click', function(e) {
              e.stopPropagation();
              e.preventDefault();
              selectElement(this);
            });
            
            newElement.addEventListener('dblclick', function(e) {
              e.stopPropagation();
              e.preventDefault();
              makeElementEditable(this);
            });
          }
        });
        
        // Gestionnaire de clics sur le document
        templateDoc.addEventListener('click', function(e) {
          if (e.target === templateDoc.body || e.target === templateDoc.documentElement) {
            clearSelection();
          }
        });
        
      } catch (error) {
        console.error('Erreur lors de la configuration:', error);
        showNotification('Erreur lors de la configuration de l\'√©dition', 'error');
      }
    }
    
    // Fonction pour rendre un √©l√©ment √©ditable inline
    function makeElementEditable(element) {
      if (!element || element === templateDoc.body) return;
      
      // Sauvegarder le contenu original
      const originalContent = element.innerHTML;
      
      // Rendre l'√©l√©ment √©ditable
      element.contentEditable = true;
      element.style.cursor = 'text';
      element.style.outline = '2px dashed #8b5cf6';
      element.style.outlineOffset = '2px';
      element.focus();
      
      // S√©lectionner tout le texte
      const selection = templateDoc.getSelection();
      const range = templateDoc.createRange();
      range.selectNodeContents(element);
      selection.removeAllRanges();
      selection.addRange(range);
      
      // G√©rer la fin de l'√©dition
      function finishEditing() {
        element.contentEditable = false;
        element.style.cursor = '';
        element.style.outline = '';
        
        if (element.innerHTML !== originalContent) {
          addToHistory();
          autoSave();
          showNotification('Texte modifi√© avec succ√®s', 'success');
          buildElementTree();
        }
        
        // R√©activer les √©v√©nements normaux
        setTimeout(() => {
          setupTemplateInteraction();
        }, 100);
      }
      
      // √âv√©nements pour terminer l'√©dition
      element.addEventListener('blur', finishEditing, { once: true });
      
      element.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          element.blur();
        }
        if (e.key === 'Escape') {
          e.preventDefault();
          element.innerHTML = originalContent;
          element.blur();
        }
      }, { once: true });
    }
    
    // S√©lectionner un √©l√©ment avec animation - VERSION SIMPLIFI√âE ET FONCTIONNELLE
    function selectElement(element) {
      if (selectedElement) {
        selectedElement.classList.remove('sp-selected');
      }
      
      selectedElement = element;
      element.classList.add('sp-selected');
      element.scrollIntoView({ behavior: 'smooth', block: 'center' });
      
      updatePropertyPanel(element);
      updateElementPath(element);
      highlightInTree(element);
    }
    
    // D√©s√©lectionner
    function clearSelection() {
      if (selectedElement) {
        selectedElement.classList.remove('sp-selected');
        selectedElement = null;
        
        document.getElementById('elementInfo').innerHTML = `
          <p style="color: var(--text-muted); text-align: center; margin-top: 24px;">
            <span style="font-size: 32px;">üëÜ</span><br>
            Cliquez sur un √©l√©ment dans le template pour le modifier
          </p>
        `;
        document.getElementById('classEditor').value = '';
        document.getElementById('textEditor').value = '';
        document.getElementById('currentClasses').innerHTML = '';
        document.getElementById('elementPath').textContent = '';
        document.getElementById('classPreview').style.display = 'none';
      }
    }
    
    // Mise √† jour du panneau de propri√©t√©s am√©lior√©
    function updatePropertyPanel(element) {
      const info = document.getElementById('elementInfo');
      const classEditor = document.getElementById('classEditor');
      const textEditor = document.getElementById('textEditor');
      const currentClasses = document.getElementById('currentClasses');
      
      // Informations d√©taill√©es de l'√©l√©ment
      const dimensions = element.getBoundingClientRect();
      const computedStyle = templateDoc.defaultView.getComputedStyle(element);
      
      info.innerHTML = `
        <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(236, 72, 153, 0.05)); 
                    padding: 12px; border-radius: 8px; margin-bottom: 12px;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 13px;">
            <div><strong>Tag:</strong> <span style="color: var(--primary);">&lt;${element.tagName.toLowerCase()}&gt;</span></div>
            <div><strong>ID:</strong> ${element.id ? `<span style="color: var(--accent);">#${element.id}</span>` : 'aucun'}</div>
            <div><strong>Classes:</strong> ${element.className.split(' ').filter(c => c && !c.startsWith('sp-')).length || 0}</div>
            <div><strong>Enfants:</strong> ${element.children.length}</div>
            <div><strong>Largeur:</strong> ${Math.round(dimensions.width)}px</div>
            <div><strong>Hauteur:</strong> ${Math.round(dimensions.height)}px</div>
            <div><strong>Display:</strong> ${computedStyle.display}</div>
            <div><strong>Position:</strong> ${computedStyle.position}</div>
          </div>
        </div>
      `;
      
      // Classes CSS
      classEditor.value = element.className.replace(/sp-\S+/g, '').trim();
      
      // Contenu texte
      const textNodes = Array.from(element.childNodes).filter(node => node.nodeType === 3);
      textEditor.value = textNodes.map(node => node.textContent).join('').trim();
      
      // Afficher les classes actuelles avec cat√©gorisation
      const classes = element.className.split(' ').filter(c => c.trim() && !c.startsWith('sp-'));
      currentClasses.innerHTML = '';
      
      if (classes.length > 0) {
        classes.forEach(className => {
          const span = document.createElement('span');
          span.className = 'class-item' + (isTailwindClass(className) ? ' tailwind' : '');
          span.textContent = className;
          span.title = 'Cliquez pour supprimer';
          span.addEventListener('click', () => {
            removeClass(className);
          });
          currentClasses.appendChild(span);
        });
      } else {
        currentClasses.innerHTML = '<span style="color: var(--text-muted); font-size: 12px;">Aucune classe CSS</span>';
      }
      
      // Afficher l'aper√ßu des classes
      previewClasses();
    }
    
    // Mettre √† jour le chemin de l'√©l√©ment avec style
    function updateElementPath(element) {
      const path = [];
      let current = element;
      
      while (current && current !== templateDoc.body) {
        let selector = current.tagName.toLowerCase();
        if (current.id) selector = `<span style="color: var(--accent);">#${current.id}</span>`;
         else if (current.className) {
          const firstClass = current.className.split(' ').find(c => c && !c.startsWith('sp-'));
          if (firstClass) selector += `<span style="color: var(--primary);">.${firstClass}</span>`;
        }
        path.unshift(selector);
        current = current.parentElement;
      }
      
      document.getElementById('elementPath').innerHTML = path.join(' ‚Ä∫ ');
    }
    
    // V√©rifier si c'est une classe Tailwind
    function isTailwindClass(className) {
      const tailwindPrefixes = ['bg-', 'text-', 'p-', 'm-', 'w-', 'h-', 'flex', 'grid', 'border', 'rounded', 
                                'shadow', 'hover:', 'focus:', 'transition', 'animate', 'font-', 'space-'];
      return tailwindPrefixes.some(prefix => className.startsWith(prefix));
    }
    
    // Supprimer une classe
    function removeClass(className) {
      if (selectedElement) {
        selectedElement.classList.remove(className);
        updatePropertyPanel(selectedElement);
        addToHistory();
        autoSave();
        showNotification(`Classe "${className}" supprim√©e`, 'success');
      }
    }
    
    // Construire l'arbre des √©l√©ments
    function buildElementTree() {
      const inspector = document.getElementById('elementInspector');
      inspector.innerHTML = '';
      
      if (!templateDoc || !templateDoc.body) {
        inspector.innerHTML = '<div style="padding: 24px; text-align: center; color: var(--text-muted);">Aucun template charg√©</div>';
        return;
      }
      
      function buildTreeNode(element, level = 0) {
        if (!element.tagName || ['SCRIPT', 'STYLE', 'META', 'LINK'].includes(element.tagName)) return;
        
        const item = document.createElement('div');
        item.className = 'element-item';
        item.style.paddingLeft = `${14 + level * 20}px`;
        
        const hasText = Array.from(element.childNodes).some(node => 
          node.nodeType === 3 && node.textContent.trim()
        );
        
        if (hasText) item.classList.add('editable');
        
        const tag = element.tagName.toLowerCase();
        const id = element.id ? `#${element.id}` : '';
        const classes = element.className.split(' ')
          .filter(c => c && !c.startsWith('sp-'))
          .slice(0, 2)
          .join('.');
        
        item.innerHTML = `
          <span style="color: var(--primary);">&lt;${tag}&gt;</span>
          ${id ? `<span style="color: var(--accent); margin-left: 4px;">${id}</span>` : ''}
          ${classes ? `<span style="color: var(--text-muted); margin-left: 4px;">.${classes}</span>` : ''}
        `;
        
        item.addEventListener('click', (e) => {
          e.stopPropagation();
          selectElement(element);
          document.querySelectorAll('.element-item').forEach(i => i.classList.remove('selected'));
          item.classList.add('selected');
        });
        
        inspector.appendChild(item);
        
        Array.from(element.children).forEach(child => {
          buildTreeNode(child, level + 1);
        });
      }
      
      buildTreeNode(templateDoc.body);
    }
    
    // Mettre en surbrillance dans l'arbre
    function highlightInTree(element) {
      const items = document.querySelectorAll('.element-item');
      items.forEach(item => item.classList.remove('selected'));
    }
    
    // Rechercher des √©l√©ments dans l'arbre
    function searchElements() {
      const searchTerm = document.getElementById('elementSearch').value.toLowerCase();
      const items = document.querySelectorAll('.element-item');
      
      items.forEach(item => {
        const text = item.textContent.toLowerCase();
        if (text.includes(searchTerm)) {
          item.style.display = 'flex';
        } else {
          item.style.display = 'none';
        }
      });
    }
    
    // Gestion de l'historique
    function addToHistory() {
      if (templateDoc) {
        const state = templateDoc.documentElement.outerHTML;
        history.push(state);
        if (history.length > maxHistorySize) {
          history.shift();
        }
        redoStack = [];
        updateHistoryButtons();
      }
    }
    
    function updateHistoryButtons() {
      document.getElementById('undoBtn').disabled = history.length <= 1;
      document.getElementById('redoBtn').disabled = redoStack.length === 0;
    }
    
    function undo() {
      if (history.length > 1) {
        redoStack.push(history.pop());
        const previousState = history[history.length - 1];
        loadTemplate(previousState);
        updateHistoryButtons();
        showNotification('Action annul√©e', 'success');
      }
    }
    
    function redo() {
      if (redoStack.length > 0) {
        const nextState = redoStack.pop();
        history.push(nextState);
        loadTemplate(nextState);
        updateHistoryButtons();
        showNotification('Action r√©tablie', 'success');
      }
    }
    
    // Mettre √† jour les classes
    function updateClasses() {
      if (selectedElement) {
        const newClasses = document.getElementById('classEditor').value;
        selectedElement.className = newClasses + ' sp-editable sp-selected';
        updatePropertyPanel(selectedElement);
        buildElementTree();
        addToHistory();
        autoSave();
        showNotification('Classes mises √† jour', 'success');
      }
    }
    
    // Mettre √† jour le texte
    function updateText() {
      if (selectedElement) {
        const newText = document.getElementById('textEditor').value;
        const textNodes = Array.from(selectedElement.childNodes).filter(node => node.nodeType === 3);
        
        if (textNodes.length > 0) {
          textNodes[0].textContent = newText;
          textNodes.slice(1).forEach(node => node.remove());
        } else if (newText) {
          selectedElement.insertBefore(document.createTextNode(newText), selectedElement.firstChild);
        }
        
        buildElementTree();
        addToHistory();
        autoSave();
        showNotification('Texte mis √† jour', 'success');
      }
    }
    
    // √âdition rapide
    function quickEdit() {
      if (selectedElement) {
        makeElementEditable(selectedElement);
      } else {
        showNotification('S√©lectionnez d\'abord un √©l√©ment', 'warning');
      }
    }
    
    // Dupliquer un √©l√©ment
    function duplicateElement() {
      if (selectedElement && selectedElement.parentElement) {
        const clone = selectedElement.cloneNode(true);
        clone.classList.remove('sp-selected');
        selectedElement.parentElement.insertBefore(clone, selectedElement.nextSibling);
        setTimeout(() => {
          setupTemplateInteraction();
          buildElementTree();
          addToHistory();
          autoSave();
        }, 100);
        showNotification('√âl√©ment dupliqu√©', 'success');
      }
    }
    
    // Supprimer un √©l√©ment
    function deleteElement() {
      if (selectedElement && selectedElement !== templateDoc.body) {
        selectedElement.remove();
        selectedElement = null;
        clearSelection();
        buildElementTree();
        addToHistory();
        autoSave();
        showNotification('√âl√©ment supprim√©', 'success');
      }
    }
    
    // Gestion du t√©l√©chargement de fichiers
    function handleFileUpload(e) {
      const file = e.target.files[0];
      if (file && file.type === 'text/html') {
        const reader = new FileReader();
        reader.onload = (event) => {
          loadTemplate(event.target.result);
        };
        reader.readAsText(file);
      }
    }
    
    // Charger √† partir du code
    function loadFromCode() {
      const code = document.getElementById('htmlCodeInput').value;
      if (code.trim()) {
        loadTemplate(code);
        document.getElementById('htmlCodeInput').value = '';
      }
    }
    
    // Charger un exemple
    function loadExample() {
      const exampleHTML = `<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landing Page Exemple</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
</head>
<body class="bg-gray-50">
  <header class="bg-white shadow-lg">
    <nav class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="text-2xl font-bold text-purple-600">MonSite</div>
        <div class="flex space-x-6">
          <a href="#" class="text-gray-700 hover:text-purple-600 transition">Accueil</a>
          <a href="#" class="text-gray-700 hover:text-purple-600 transition">Services</a>
          <a href="#" class="text-gray-700 hover:text-purple-600 transition">Contact</a>
        </div>
      </div>
    </nav>
  </header>
  
  <section class="container mx-auto px-6 py-16">
    <div class="text-center">
      <h1 class="text-5xl font-bold text-gray-900 mb-4">Bienvenue sur SimplePlate</h1>
      <p class="text-xl text-gray-600 mb-8">Cr√©ez et modifiez vos templates HTML avec Tailwind CSS</p>
      <button class="bg-purple-600 text-white px-8 py-4 rounded-lg hover:bg-purple-700 transition shadow-lg">
        Commencer maintenant
      </button>
    </div>
  </section>
  
  <section class="container mx-auto px-6 py-16">
    <div class="grid md:grid-cols-3 gap-8">
      <div class="bg-white p-8 rounded-lg shadow-md hover:shadow-xl transition">
        <div class="text-4xl mb-4">üöÄ</div>
        <h3 class="text-xl font-bold mb-2">Rapide</h3>
        <p class="text-gray-600">√âditez vos templates en temps r√©el</p>
      </div>
      <div class="bg-white p-8 rounded-lg shadow-md hover:shadow-xl transition">
        <div class="text-4xl mb-4">üé®</div>
        <h3 class="text-xl font-bold mb-2">Moderne</h3>
        <p class="text-gray-600">Utilisez Tailwind CSS pour un design moderne</p>
      </div>
      <div class="bg-white p-8 rounded-lg shadow-md hover:shadow-xl transition">
        <div class="text-4xl mb-4">üí°</div>
        <h3 class="text-xl font-bold mb-2">Intuitif</h3>
        <p class="text-gray-600">Interface simple et facile √† utiliser</p>
      </div>
    </div>
  </section>
</body>
</html>`;
      loadTemplate(exampleHTML);
    }
    
    // Gestion du glisser-d√©poser
    function handleDragOver(e) {
      e.preventDefault();
      dropZone.classList.add('active');
    }
    
    function handleDragLeave() {
      dropZone.classList.remove('active');
    }
    
    function handleDrop(e) {
      e.preventDefault();
      dropZone.classList.remove('active');
      
      const file = e.dataTransfer.files[0];
      if (file && file.type === 'text/html') {
        const reader = new FileReader();
        reader.onload = (event) => {
          loadTemplate(event.target.result);
        };
        reader.readAsText(file);
      }
    }
    
    // Changer la vue (desktop/tablet/mobile)
    function changeViewport() {
      const viewport = this.dataset.viewport;
      const wrapper = document.getElementById('canvasWrapper');
      
      document.querySelectorAll('.viewport-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      
      wrapper.className = 'canvas-wrapper';
      if (viewport === 'tablet') wrapper.classList.add('tablet');
      if (viewport === 'mobile') wrapper.classList.add('mobile');
      
      showNotification(`Vue ${viewport} activ√©e`, 'success');
    }
    
    // Ajouter une classe Tailwind rapide
    function addTailwindClass() {
      if (selectedElement) {
        selectedElement.classList.add(this.dataset.class);
        updatePropertyPanel(selectedElement);
        addToHistory();
        autoSave();
        showNotification(`Classe "${this.dataset.class}" ajout√©e`, 'success');
      } else {
        showNotification('S√©lectionnez d\'abord un √©l√©ment', 'warning');
      }
    }
    
    // Aper√ßu des classes
    function previewClasses() {
      const classPreview = document.getElementById('classPreview');
      const classEditor = document.getElementById('classEditor');
      
      if (classEditor.value.trim()) {
        classPreview.textContent = `Classes: ${classEditor.value}`;
        classPreview.style.display = 'block';
      } else {
        classPreview.style.display = 'none';
      }
    }
    
    // Pr√©visualiser le template
    function previewTemplate() {
      if (templateDoc) {
        const previewWindow = window.open('', '_blank');
        const cleanHTML = templateDoc.documentElement.outerHTML
          .replace(/sp-editable|sp-selected|sp-highlight/g, '')
          .replace(/data-sp-index="[^"]*"/g, '');
        previewWindow.document.write(cleanHTML);
        previewWindow.document.close();
        showNotification('Aper√ßu ouvert dans une nouvelle fen√™tre', 'success');
      }
    }
    
    // Exporter le template
    function exportTemplate() {
      if (templateDoc) {
        const cleanHTML = templateDoc.documentElement.outerHTML
          .replace(/sp-editable|sp-selected|sp-highlight/g, '')
          .replace(/data-sp-index="[^"]*"/g, '')
          .replace(/\s+class=""/g, '');
        
        const blob = new Blob([cleanHTML], { type: 'text/html;charset=utf-8' });
        saveAs(blob, 'template-export.html');
        showNotification('Template export√© avec succ√®s !', 'success');
      }
    }
    
    // Basculer les sections
    function toggleSection() {
      const content = this.nextElementSibling;
      const icon = this.querySelector('.toggle-icon');
      
      content.classList.toggle('collapsed');
      icon.style.transform = content.classList.contains('collapsed') ? 'rotate(-90deg)' : 'rotate(0)';
    }
    
    // Sauvegarde automatique
    function autoSave() {
      if (isAutoSaving || !templateDoc) return;
      
      isAutoSaving = true;
      const indicator = document.getElementById('autoSaveIndicator');
      const savingIcon = indicator.querySelector('.saving');
      const saveStatus = document.getElementById('saveStatus');
      
      savingIcon.style.display = 'inline';
      saveStatus.textContent = 'Sauvegarde...';
      
      // Simuler un d√©lai de sauvegarde
      setTimeout(() => {
        if (templateDoc) {
          const htmlContent = templateDoc.documentElement.outerHTML;
          localStorage.setItem('simpleplate-template', htmlContent);
          localStorage.setItem('simpleplate-last-save', new Date().toISOString());
        }
        
        savingIcon.style.display = 'none';
        saveStatus.textContent = 'Sauvegard√©';
        
        // R√©initialiser apr√®s 2 secondes
        setTimeout(() => {
          saveStatus.textContent = 'Sauvegard√©';
        }, 2000);
        
        isAutoSaving = false;
      }, 500);
    }
  </script>
</body>
</html>